<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MRW track control (next generation): MRW Track Control NG</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../mrw128.gif"/></td>
  <td id="projectalign">
   <div id="projectname">MRW track control (next generation)
   </div>
   <div id="projectbrief">Welcome to the modelrailway next generation.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">MRW Track Control NG</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the next generation Qt based track control software based on the MRW project. It reads the modelrailway file, which is XML/XMI based and displays the GUI to control the model railway.</p>
<h1>Data flow architecture</h1>
<div class="fragment"><div class="line">flowchart TB</div>
<div class="line">    subgraph Eclipse</div>
<div class="line">    Modelrailway.umlclass -- converts --&gt; Ecore --&gt; GenModel</div>
<div class="line">    GenModel --&gt; Modelleditor-Plugin</div>
<div class="line">    Ecore --&gt; Modelleditor-Plugin</div>
<div class="line">    end</div>
<div class="line">    Modelleditor-Plugin -- edit --&gt; MRW.modelrailway -- uses --&gt; MRW-NG</div>
<div class="line">    subgraph Qt-App</div>
<div class="line">    MRW-NG -. creates .-&gt; Settings</div>
<div class="line">    Signal.properties -. converts .-&gt; MRW-NG</div>
<div class="line">    Gruppe.properties -. converts .-&gt; MRW-NG</div>
<div class="line">    Gleisteile.properties -. converts .-&gt; MRW-NG</div>
<div class="line">    end</div>
</div><!-- fragment --><h1>Installation</h1>
<p>To install precompiled software on your ubuntu system you have to prepare the APT subsystem. First you have to download the keyring:</p>
<pre style="white-space: nowrap;">
sudo wget -O /etc/apt/trusted.gpg.d/mrw.gpg <a href="http://eisenbahnsteuerung.org/mrw.gpg">http://eisenbahnsteuerung.org/mrw.gpg</a>
</pre><p>Now you can add an entry into your <em>sources.list</em> file, but it is better to put the line into its own file (*/etc/apt/sources.list.d/mrw.list*):</p>
<pre style="white-space: nowrap;">
deb [signed-by=/etc/apt/trusted.gpg.d/mrw.gpg] <a href="http://eisenbahnsteuerung.org/apt/">http://eisenbahnsteuerung.org/apt/</a> mrw common firmware
</pre><p>After that you can update and install the software: </p><div class="fragment"><div class="line">sudo apt update</div>
<div class="line">sudo apt install mrw-ng</div>
</div><!-- fragment --><h1>Building the project</h1>
<p>You have two choices building the complete project <em>qmake</em>/*qmake6* or <em>cmake</em>. Except with <em>qmake6</em> you can also cross compile the project for different target architectures.</p>
<h2>qmake</h2>
<p>For a host build you can simply build the project using the following command sequence: </p><div class="fragment"><div class="line">qmake</div>
<div class="line">build -j `nproc`</div>
</div><!-- fragment --><p> Instead of using <em>qmake</em> for Qt5 you can use <em>qmake6</em> which selects Qt6. Both Qt versions can coexist on the host development machine.</p>
<p>For cross builds using Qt5 you need a custom target development build of Qt. This build contains host binaries for preparing the build such as <em>qmake</em>, <em>moc</em> or <em>uic</em> and target headers and libraries for compiling and linking. So the sysroot does not need any Qt package installation. See the Qt Wiki for more details for creating such a cross built Qt. You can cross build this project using the following sequence: </p><div class="fragment"><div class="line">&lt;path-to-dev-qt&gt;/bin/qmake</div>
<div class="line">build -j `nproc`</div>
</div><!-- fragment --><p> Note that the target architecture and their paths is encoded into the cross built Qt.</p>
<h2>cmake</h2>
<p>Since Qt6 will end support for <em>qmake</em> in the future there is also a <em>cmake</em> build possibility. This <em>cmake</em> build does not support Qt5 anymore. There is also a simple way to cross compile this project. To build this project simply use the usual command sequence: </p><div class="fragment"><div class="line">cmake -B build</div>
<div class="line">cmake --build --parallel</div>
</div><!-- fragment --><p> For cross builds the sysroot needs the installation of the Qt6 development packages. The build needs three more variables. One for defining the toolchain file which describes the cross compiler and the sysroot as usual. </p><div class="fragment"><div class="line">cmake -B build -DQT_HOST_PATH=/ \</div>
<div class="line">    -DQT_HOST_PATH_CMAKE_DIR=/usr/lib/x86_64-linux-gnu/cmake \</div>
<div class="line">    -DCMAKE_TOOLCHAIN_FILE=&lt;fq-path-to-toolchain-file&gt; </div>
<div class="line">cmake --build --parallel</div>
</div><!-- fragment --><h2>macOS</h2>
<p>If you want to compile on Apple macOS you have to install MacPorts and Qt for macOS.</p>
<h3>Qt for macOS</h3>
<p>Qt provides a net installer for the community edition. You must have a valid Qt account to download and install the Qt components. Do not forget to install the additional libraries (hidden under the Qt version to install) for</p><ul>
<li>Qt Serial Bus</li>
<li>Qt Serial Port</li>
</ul>
<h3>MacPorts</h3>
<p>Since there are some more components to use I recommend to install them using the MacPorts framework. After installing MacPorts you can install the necessary packages using the following commands: </p><div class="fragment"><div class="line">sudo port install cmake gtest doxygen dot astyle</div>
</div><!-- fragment --><h3>Build for macOS</h3>
<p>After setting the environment variable <em>Qt6_DIR</em> you can compile using the <em>cmake</em> option above.</p>
<h2>Starting the application</h2>
<p>To start the track control software refer to the README of the MRW-TrackControl application. It additionally contains information about configuring the CAN bus and prepare the EGL on Raspberry Pi mini computers.</p>
<h1>Software packages and namespaces</h1>
<p>The software is organized in packages each using its own namespace. Every package result in a static library. There are the following packages:</p><ul>
<li><a class="el" href="../../d9/d2b/namespacemrw_1_1util.html" title="The mrw::util namespace contains some classes to make live easier.">mrw::util</a>, libMRW-Util.a which contains convenience classes.</li>
<li><a class="el" href="../../d8/d91/namespacemrw_1_1log.html" title="The mrw::log namespace provieds classes vor convenient Qt logging.">mrw::log</a>, libMRW-Log.a which contains logging classes.</li>
<li><a class="el" href="../../d9/d9b/namespacemrw_1_1can.html" title="The mrw::can namespace provides the CAN bus infrastructure using the Qt serialbus API.">mrw::can</a>, libMRW-Can.a which contains the CAN support.</li>
<li><a class="el" href="../../d9/dbc/namespacemrw_1_1model.html" title="The mrw::model namespace contains all data/model classes for describing a complete model railway.">mrw::model</a>, libMRW-Model.a which contains the data model of model railways.</li>
<li><a class="el" href="../../d1/d18/namespacemrw_1_1ctrl.html" title="The mrw::ctrl namespace contains all controller classes in the meaning of the MVC paradigma.">mrw::ctrl</a>, libMRW-Ctrl.a which contains logic classes.</li>
<li><a class="el" href="../../d1/de6/namespacemrw_1_1ui.html" title="The mrw::ui namespace contains all custom widget classes needed for the MRW next generation track con...">mrw::ui</a>, libMRW-UI.a which contains widgets for graphical interaction.</li>
<li>mrw::statecharts, libMRW-Statecharts.a which contains state machines supporting the controller classes.</li>
</ul>
<p>The packages have dependencies as shown in the following diagram: </p><div class="fragment"><div class="line">flowchart BT</div>
<div class="line">    model[mrw::model]</div>
<div class="line">    sc[mrw::statecharts]</div>
<div class="line">    ui[mrw::ui]</div>
<div class="line">    util[mrw::util]</div>
<div class="line">    can[mrw::can]</div>
<div class="line">    ctrl[mrw::ctrl]</div>
<div class="line">    log[mrw::log]</div>
<div class="line"> </div>
<div class="line">    can --&gt;|depends|util</div>
<div class="line">    ui --&gt;|depends|util</div>
<div class="line">    ctrl --&gt;|depends|util</div>
<div class="line">    ctrl --&gt;|depends|model</div>
<div class="line">    ctrl --&gt;|depends|can</div>
<div class="line">    ui --&gt;|depends|ctrl</div>
<div class="line">    model --&gt;|depends|util</div>
<div class="line">    model --&gt;|depends|can</div>
<div class="line">    ctrl --&gt;|depends|sc</div>
<div class="line">    log --&gt;|depends|util</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 27 2025 16:10:40 for MRW track control (next generation) by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
